<html lang="vi">
<head>
<meta charset="UTF-8">
<title>TRANTROL MUSIC</title>

<style>
:root {
  --green: #1db954;
  --dark: #121212;
  --dark2: #181818;
  --dark3: #222;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: "Segoe UI", Arial, sans-serif;
  background: var(--dark);
  color: white;
}

/* ===== HEADER ===== */
header {
  background: linear-gradient(90deg, #1db954, #1ed760);
  padding: 20px;
  text-align: center;
}
header h1 {
  margin: 0;
  font-size: 28px;
  letter-spacing: 2px;
}
header p {
  margin: 5px 0 0;
  opacity: 0.9;
}

/* ===== LAYOUT ===== */
.container {
  display: grid;
  grid-template-columns: 350px 1fr;
  gap: 20px;
  padding: 20px;
}

/* ===== CARD ===== */
.card {
  background: var(--dark2);
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
}

.card h2 {
  margin-top: 0;
}

/* ===== UPLOAD ===== */
input, button {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  border-radius: 8px;
  border: none;
  font-size: 14px;
}

input {
  background: #2a2a2a;
  color: white;
}

button {
  background: var(--green);
  font-weight: bold;
  cursor: pointer;
}

button:hover {
  filter: brightness(1.1);
}

/* ===== MUSIC LIST ===== */
.music-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px;
  border-radius: 8px;
  margin-bottom: 10px;
  background: var(--dark3);
  cursor: pointer;
  transition: 0.2s;
}

.music-item:hover {
  background: #2e2e2e;
}

.music-title {
  font-weight: 500;
}

.play {
  color: var(--green);
  font-size: 18px;
}

/* ===== PLAYER ===== */
.player {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: #000;
  padding: 10px 20px;
  border-top: 1px solid #333;
}

audio {
  width: 100%;
}

/* ===== MOBILE ===== */
@media (max-width: 800px) {
  .container {
    grid-template-columns: 1fr;
  }
}
</style>
</head>

<body>

<header>
  <h1>üéß TRANTROL MUSIC</h1>
  <p>N·ªÅn t·∫£ng chia s·∫ª & nghe nh·∫°c c√° nh√¢n</p>
</header>

<div class="container">
  <!-- UPLOAD -->
  <div class="card">
    <h2>‚¨ÜÔ∏è ƒêƒÉng nh·∫°c</h2>
    <input id="title" placeholder="T√™n b√†i h√°t">
    <input type="file" id="file" accept="audio/*">
    <button onclick="saveMusic()">ƒêƒÉng nh·∫°c</button>
  </div>

  <!-- LIST -->
  <div class="card">
    <h2>üé∂ Th∆∞ vi·ªán nh·∫°c</h2>
    <div id="list"></div>
  </div>
</div>

<div class="player">
  <audio id="player" controls></audio>
</div>

<script>
let db;
const request = indexedDB.open("TrantrolMusicDB", 1);

request.onupgradeneeded = e => {
  db = e.target.result;
  db.createObjectStore("music", { keyPath: "id", autoIncrement: true });
};

request.onsuccess = e => {
  db = e.target.result;
  loadMusic();
};

function saveMusic() {
  const title = document.getElementById("title").value.trim();
  const file = document.getElementById("file").files[0];

  if (!title || !file) {
    alert("Vui l√≤ng nh·∫≠p t√™n b√†i h√°t v√† ch·ªçn file!");
    return;
  }

  const reader = new FileReader();
  reader.onload = () => {
    const tx = db.transaction("music", "readwrite");
    tx.objectStore("music").add({
      title,
      data: reader.result
    });
    tx.oncomplete = () => {
      document.getElementById("title").value = "";
      document.getElementById("file").value = "";
      loadMusic();
    };
  };
  reader.readAsDataURL(file);
}

function loadMusic() {
  const list = document.getElementById("list");
  list.innerHTML = "";

  const tx = db.transaction("music", "readonly");
  const store = tx.objectStore("music");

  store.openCursor().onsuccess = e => {
    const cursor = e.target.result;
    if (cursor) {
      const item = document.createElement("div");
      item.className = "music-item";
      item.innerHTML = `
        <span class="music-title">${cursor.value.title}</span>
        <span class="play">‚ñ∂</span>
      `;
      item.onclick = () => {
        const player = document.getElementById("player");
        player.src = cursor.value.data;
        player.play();
      };
      list.appendChild(item);
      cursor.continue();
    }
  };
}
</script>

</body>
</html>